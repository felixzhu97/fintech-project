@startuml 业务架构图
!define BUSINESS_ACTOR #E8F4F8
!define BUSINESS_PROCESS #FFF4E6
!define BUSINESS_SERVICE #E8F5E9

skinparam linetype ortho

skinparam component {
    BackgroundColor<<Actor>> BUSINESS_ACTOR
    BackgroundColor<<Process>> BUSINESS_PROCESS
    BackgroundColor<<Service>> BUSINESS_SERVICE
    BorderColor #333333
    ArrowColor #333333
}

title TOGAF 业务架构 - FinPulse 金融科技平台

package "业务参与者层" {
    component "投资者" as Investor <<Actor>>
    component "平台管理员" as Admin <<Actor>>

    note right of Investor
        <b>主要业务参与者</b>
        - 个人投资者
        - 机构投资者
        - 投资顾问
    end note

    note right of Admin
        <b>平台管理角色</b>
        - 系统维护
        - 内容管理
        - 用户支持
    end note
}

package "核心业务功能域" {
    component "投资组合管理" as PortfolioMgmt <<Process>>
    component "市场分析" as MarketAnalysis <<Process>>
    component "风险管理" as RiskMgmt <<Process>>
    component "交易管理" as TransactionMgmt <<Process>>
    component "资产管理" as AssetMgmt <<Process>>
    component "观察列表管理" as WatchListMgmt <<Process>>
    component "债券分析" as BondAnalysis <<Process>>
    component "期权定价" as OptionsPricing <<Process>>
    component "组合优化" as PortfolioOptimization <<Process>>
    component "统计分析" as StatisticalAnalysis <<Process>>
    component "技术指标分析" as TechnicalIndicators <<Process>>
    component "估值分析" as ValuationAnalysis <<Process>>
    component "数据可视化" as DataVisualization <<Process>>
    component "大数据分析" as BigDataAnalytics <<Process>>

    note right of PortfolioMgmt
        <b>业务功能</b>
        - 资产净值监控
        - 收益统计
        - 持仓管理
        - 资产配置优化
    end note

    note right of MarketAnalysis
        <b>业务功能</b>
        - 市场趋势分析
        - 实时行情展示
        - 市场动态跟踪
        - 行情预警
    end note

    note right of RiskMgmt
        <b>业务功能</b>
        - 风险指标评估
        - 风险分布分析
        - 风险预警机制
        - 风险报告生成
    end note

    note right of BondAnalysis
        <b>业务功能</b>
        - 债券收益率计算(YTM)
        - 久期分析(Macaulay/Modified)
        - 凸度计算
        - 债券估值定价
    end note

    note right of OptionsPricing
        <b>业务功能</b>
        - Black-Scholes定价
        - 二叉树定价模型
        - Greeks计算(Delta/Gamma/Theta/Vega/Rho)
        - 隐含波动率计算
    end note

    note right of PortfolioOptimization
        <b>业务功能</b>
        - 马科维茨优化
        - 有效前沿计算
        - 最大夏普比率组合
        - 权重约束优化
    end note

    note right of StatisticalAnalysis
        <b>业务功能</b>
        - 相关性分析
        - CAPM模型
        - Fama-French模型
        - 回归分析
    end note

    note right of TechnicalIndicators
        <b>业务功能</b>
        - 移动平均线(MA/EMA)
        - 动量指标(RSI/MACD)
        - 波动率指标
        - 成交量指标
    end note

    note right of ValuationAnalysis
        <b>业务功能</b>
        - DCF估值模型
        - 相对估值法
        - 股息折现模型(DDM)
        - 估值报告生成
    end note

    note right of DataVisualization
        <b>业务功能</b>
        - K线图展示
        - 趋势图表
        - 热力图分析
        - 雷达图对比
        - 仪表盘展示
    end note

    note right of BigDataAnalytics
        <b>业务功能</b>
        - Spark批处理分析
        - Flink流处理分析
        - Hadoop数据存储与管理
        - 大规模数据处理
        - 实时数据流分析
    end note
}

package "业务服务层" {
    component "投资组合服务" as PortfolioService <<Service>>
    component "市场数据服务" as MarketService <<Service>>
    component "风险分析服务" as RiskService <<Service>>
    component "交易服务" as TransactionService <<Service>>
    component "金融计算服务" as CalculationService <<Service>>
    component "数据可视化服务" as VisualizationService <<Service>>
    component "云基础设施服务" as CloudService <<Service>>
    component "大数据服务" as BigDataService <<Service>>

    note right of PortfolioService
        提供投资组合相关的
        业务服务能力
    end note

    note right of MarketService
        提供市场数据相关的
        业务服务能力
    end note

    note right of CalculationService
        提供金融计算服务
        - 收益计算
        - 风险计算
        - 格式化工具
    end note

    note right of VisualizationService
        提供数据可视化服务
        - 图表渲染
        - 数据格式化
        - 主题管理
    end note

    note right of CloudService
        提供AWS云服务
        - S3对象存储
        - DynamoDB数据库
        - Lambda无服务器计算
        - SQS消息队列
        - SNS通知服务
        - API Gateway网关
    end note

    note right of BigDataService
        提供大数据服务
        - Spark会话管理服务
        - Flink作业管理服务
        - HDFS文件系统服务
        - YARN资源管理服务
    end note
}

' 业务参与者到业务功能的关联
Investor --> PortfolioMgmt
Investor --> MarketAnalysis
Investor --> RiskMgmt
Investor --> TransactionMgmt
Investor --> AssetMgmt
Investor --> WatchListMgmt
Investor --> BondAnalysis
Investor --> OptionsPricing
Investor --> PortfolioOptimization
Investor --> StatisticalAnalysis
Investor --> TechnicalIndicators
Investor --> ValuationAnalysis
Investor --> DataVisualization
Investor --> BigDataAnalytics

Admin --> PortfolioMgmt
Admin --> MarketAnalysis
Admin --> RiskMgmt
Admin --> CloudService
Admin --> BigDataAnalytics

' 业务功能到业务服务的关联
PortfolioMgmt --> PortfolioService
AssetMgmt --> PortfolioService
WatchListMgmt --> PortfolioService

MarketAnalysis --> MarketService
WatchListMgmt --> MarketService

RiskMgmt --> RiskService
PortfolioMgmt --> RiskService

TransactionMgmt --> TransactionService

BondAnalysis --> CalculationService
OptionsPricing --> CalculationService
PortfolioOptimization --> CalculationService
StatisticalAnalysis --> CalculationService
TechnicalIndicators --> CalculationService
ValuationAnalysis --> CalculationService
PortfolioMgmt --> CalculationService

DataVisualization --> VisualizationService
MarketAnalysis --> VisualizationService
PortfolioMgmt --> VisualizationService

BigDataAnalytics --> BigDataService

PortfolioService --> CloudService
MarketService --> CloudService
RiskService --> CloudService
TransactionService --> CloudService
CalculationService --> CloudService
BigDataService --> CloudService

' 业务功能间的价值流
PortfolioMgmt ..> RiskMgmt : 风险评估
MarketAnalysis ..> PortfolioMgmt : 投资建议
AssetMgmt ..> PortfolioMgmt : 配置优化
TransactionMgmt ..> PortfolioMgmt : 交易更新
BondAnalysis ..> PortfolioMgmt : 债券持仓分析
OptionsPricing ..> PortfolioMgmt : 期权持仓分析
PortfolioOptimization ..> PortfolioMgmt : 优化配置建议
StatisticalAnalysis ..> PortfolioMgmt : 统计特征分析
TechnicalIndicators ..> MarketAnalysis : 技术信号
ValuationAnalysis ..> PortfolioMgmt : 估值结果
DataVisualization ..> PortfolioMgmt : 可视化展示
MarketAnalysis ..> BigDataAnalytics : 数据洞察
TransactionMgmt ..> BigDataAnalytics : 模式识别
BigDataAnalytics ..> PortfolioMgmt : 数据洞察
BigDataAnalytics ..> RiskMgmt : 模式识别
BigDataAnalytics ..> StatisticalAnalysis : 增强分析能力

legend right
    |<#E8F4F8> 业务参与者 |
    |<#FFF4E6> 业务功能 |
    |<#E8F5E9> 业务服务 |
    |
    <b>关系说明：</b>
    --> 直接关联
    ..> 业务流程依赖
endlegend

@enduml
